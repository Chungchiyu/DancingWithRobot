{"version":3,"sources":["src/player.js"],"names":["_regeneratorRuntime","e","t","r","Object","prototype","n","hasOwnProperty","o","defineProperty","value","i","Symbol","a","iterator","c","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","call","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","p","d","getPrototypeOf","v","values","g","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","_typeof","resolve","__await","then","callInvokeWithMethodAndArg","Error","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","return","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","isNaN","length","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","slice","stop","rval","handle","complete","finish","catch","_catch","delegateYield","ownKeys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","apply","_objectSpread","arguments","_defineProperty","getOwnPropertyDescriptors","defineProperties","_toPropertyKey","_toPrimitive","toPrimitive","String","Number","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","_arrayLikeToArray","toString","Array","from","test","isArray","asyncGeneratorStep","_asyncToGenerator","_next","_throw","window","video","document","getElementById","canvas","progressContainer","progressFilled","progressThumb","loading","querySelector","fileInput","selectVideoButton","restartButton","closeButton","poseButton","leftSide","rightSide","poseDetectToggle","linkRobot","DEG2RAD","Math","PI","poseNetLoaded","lastPoses","lastPoseAngles","videoAspectRatio","lowResCanvas","lowResolution","addEventListener","LoadMediaPipe","periodicPoseEstimation","model","detector","initPoseDetector","_initPoseDetector","_callee","detectorConfig","_callee$","_context","poseDetection","SupportedModels","BlazePose","runtime","modelType","solutionPath","enableSmoothing","enableSegmentation","smoothSegmentation","minDetectionConfidence","minTrackingConfidence","createDetector","detectPose","_x","_x2","_detectPose","_callee2","_callee2$","_context2","estimatePoses","flipHorizontal","_LoadMediaPipe","_callee3","_callee3$","_context3","console","log","t0","error","totalTimeEl","textContent","formatTime","duration","videoWidth","videoHeight","resizeCanvas","createLowResCanvas","updateProgress","startProgressDrag","click","loadVideo","restart","closeVideo","classList","toggle","contains","style","display","recordDataButton","add","remove","createElement","aspectRatio","width","height","round","containerRect","getBoundingClientRect","containerWidth","containerHeight","canvasWidth","canvasHeight","position","top","concat","drawPoses","poses","ctx","getContext","clearRect","scaleX","scaleY","minDimension","min","keyPointRadius","lineWidth","pose","connections","util","getAdjacentPairs","_ref","_ref2","j","kp1","keypoints","kp2","score","beginPath","moveTo","x","lineTo","strokeStyle","stroke","keypoint","index","noDraw","arc","fillStyle","fill","angles","calculateAllAngles","keypoints3D","groupNameSelected","displayAngles","remapAngles","angleMapping","groups","selectedGroup","data","viewer","robot","joints","map","jointName","setJointValue","entries","groupData","angleOut","joint","angle","mappingData","undefined","clampedAngle","max","PL","PR","AHL","AHR","input","in_min","in_max","out_min","out_max","groupName","group","find","_ref3","_ref4","key","points","split","id","trim","_points$map","includes","parseInt","z","_points$map2","b","calculateAngle","is3D","warn","_points$map3","_points$map4","A","B","C","D","withCoord","BA","BC","calculateAngleBetweenVectors","cross","crossProduct","dot","dotProduct","calculateAngle2D","AB","CD","magnitudeAB","sqrt","magnitudeCD","acos","v1","v2","det","atan2","abs","magnitudeV1","magnitudeV2","context","font","text","strokeText","fillText","_i","_Object$entries","_Object$entries$_i","toFixed","_x3","_loadVideo","_callee4","event","file","_callee4$","_context4","target","files","src","URL","createObjectURL","play","pause","generateThumbnails","pointerEvents","updateMarkers","playPauseAnimation","togglePlayPause","paused","className","setTimeout","currentTime","requestAnimationFrame","jointsData","recordData","poseAngles","newData","time","inserted","splice","addMarkerToProgressBar","addFrameCard","progress","marker","appendChild","left","clientWidth","stopPropagation","thickness","updateProgressWithEvent","stopProgressDrag","body","userSelect","removeEventListener","rect","clientX","newTime","_generateThumbnails","_callee5","thumbnailCount","thumbnailCanvas","thumbnailTime","thumbnailDiv","thumbnails","_callee5$","_context5","setVideoCurrentTime","insertBefore","drawImage","backgroundImage","toDataURL","querySelectorAll","thumbnail","_x4","_x5","_setVideoCurrentTime","_callee6","_callee6$","_context6","once","isDragging","onDrag","stopDrag","newWidth","lastProcessedTime","processingInterval","estimationCount","maxEstimations","updatePose","_x6","_estimatePoses","_callee7","refresh","_callee7$","_context7","readyState","poseList","innerHTML","angleDefinitions","zIndex","currentTimeEl","seconds","minutes","floor","remainingSeconds","padStart","preventDefault"],"mappings":"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","file":"player.13e516db.js","sourceRoot":"..","sourcesContent":["window.video = document.getElementById('video');\r\nconst canvas = document.getElementById('canvas');\r\nwindow.progressContainer = document.getElementById('progress-container');\r\nconst progressFilled = document.getElementById('progress-filled');\r\nconst progressThumb = document.getElementById('progress-thumb');\r\nconst loading = document.querySelector('.loading');\r\nconst fileInput = document.getElementById('file-input');\r\nconst selectVideoButton = document.getElementById('select-video');\r\n// const playPauseButton = document.getElementById('play-pause');\r\nconst restartButton = document.getElementById('restart');\r\nconst closeButton = document.getElementById('close-button');\r\nconst poseButton = document.getElementById('pose-button');\r\nconst leftSide = document.getElementById('left-side');\r\nconst rightSide = document.getElementById('right-side');\r\nconst handle = document.querySelector('.divider');\r\nconst poseDetectToggle = document.getElementById('poseDetect');\r\nwindow.linkRobot = document.getElementById('link-robot');\r\nconst DEG2RAD = Math.PI / 180;\r\n\r\nlet poseNetLoaded = false;\r\nlet lastPoses = [];\r\nlet lastPoseAngles;\r\nlet videoAspectRatio = 16 / 9;\r\nlet lowResCanvas;\r\nlet lowResolution = 720;\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n  LoadMediaPipe();\r\n  periodicPoseEstimation();\r\n});\r\n\r\nlet model;\r\nlet detector;\r\n\r\nasync function initPoseDetector() {\r\n  model = poseDetection.SupportedModels.BlazePose;\r\n  const detectorConfig = {\r\n    runtime: 'mediapipe',\r\n    modelType: 'full',\r\n    solutionPath: 'https://cdn.jsdelivr.net/npm/@mediapipe/pose',\r\n    enableSmoothing: true,\r\n    enableSegmentation: false,\r\n    smoothSegmentation: true,\r\n    minDetectionConfidence: 0.5,\r\n    minTrackingConfidence: 0.5\r\n  };\r\n  return await poseDetection.createDetector(model, detectorConfig);\r\n}\r\n\r\nasync function detectPose(detector, video) {\r\n  return await detector.estimatePoses(video, {\r\n    flipHorizontal: false\r\n  });\r\n}\r\n\r\nasync function LoadMediaPipe() {\r\n  try {\r\n    detector = await initPoseDetector();\r\n    console.log('MediaPipe loaded successfully');\r\n    poseNetLoaded = true;\r\n  } catch (err) {\r\n    console.error('Error loading the MediaPipe model', err);\r\n  }\r\n}\r\n\r\nvideo.addEventListener('loadedmetadata', () => {\r\n  totalTimeEl.textContent = formatTime(video.duration);\r\n  videoAspectRatio = video.videoWidth / video.videoHeight;\r\n  resizeCanvas();\r\n  createLowResCanvas();\r\n});\r\n\r\nvideo.addEventListener('timeupdate', updateProgress);\r\nprogressContainer.addEventListener('mousedown', startProgressDrag);\r\nselectVideoButton.addEventListener('click', () => fileInput.click());\r\nfileInput.addEventListener('change', loadVideo);\r\n// playPauseButton.addEventListener('click', playPause);\r\nrestartButton.addEventListener('click', restart);\r\ncloseButton.addEventListener('click', closeVideo);\r\n\r\nposeDetectToggle.addEventListener('click', () => {\r\n  poseDetectToggle.classList.toggle('checked');\r\n  if (poseDetectToggle.classList.contains('checked')) {\r\n    canvas.style.display = '';\r\n    recordDataButton.classList.add('active');\r\n    estimatePoses();\r\n  } else {\r\n    canvas.style.display = 'none';\r\n    recordDataButton.classList.remove('active');\r\n  }\r\n});\r\n\r\nlinkRobot.addEventListener('click', () => {\r\n  linkRobot.classList.toggle('checked');\r\n  estimatePoses();\r\n});\r\n\r\nfunction createLowResCanvas() {\r\n  lowResCanvas = document.createElement('canvas');\r\n  const aspectRatio = video.videoWidth / video.videoHeight;\r\n  lowResCanvas.width = lowResolution;\r\n  lowResCanvas.height = Math.round(lowResolution / aspectRatio);\r\n}\r\n\r\nfunction resizeCanvas() {\r\n  const containerRect = leftSide.getBoundingClientRect();\r\n  const containerWidth = containerRect.width;\r\n  const containerHeight = containerRect.height;\r\n\r\n  let canvasWidth, canvasHeight;\r\n\r\n  if (containerWidth / containerHeight > videoAspectRatio) {\r\n    canvasHeight = containerHeight;\r\n    canvasWidth = canvasHeight * videoAspectRatio;\r\n  } else {\r\n    canvasWidth = containerWidth;\r\n    canvasHeight = canvasWidth / videoAspectRatio;\r\n  }\r\n\r\n  canvas.width = canvasWidth;\r\n  canvas.height = canvasHeight;\r\n\r\n  canvas.style.position = 'absolute';\r\n  canvas.style.top = `${(containerHeight - canvasHeight) / 2}px`;\r\n\r\n  if (lastPoses.length > 0) {\r\n    drawPoses(lastPoses);\r\n  }\r\n}\r\n\r\nfunction drawPoses(poses) {\r\n  lastPoses = poses;\r\n  const ctx = canvas.getContext('2d');\r\n\r\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n  const scaleX = canvas.width / video.videoWidth;\r\n  const scaleY = canvas.height / video.videoHeight;\r\n\r\n  const minDimension = Math.min(canvas.width, canvas.height);\r\n  const keyPointRadius = minDimension * 0.008;\r\n  const lineWidth = minDimension * 0.005;\r\n\r\n  if (poses.length > 0) {\r\n    const pose = poses[0];\r\n\r\n    poses.forEach(pose => {\r\n\r\n      const connections = poseDetection.util.getAdjacentPairs(model);\r\n      connections.forEach(([i, j]) => {\r\n        const kp1 = pose.keypoints[i];\r\n        const kp2 = pose.keypoints[j];\r\n        if (kp1.score > 0.3 && kp2.score > 0.3) {\r\n          ctx.beginPath();\r\n          ctx.moveTo(kp1.x * scaleX, kp1.y * scaleY);\r\n          ctx.lineTo(kp2.x * scaleX, kp2.y * scaleY);\r\n          ctx.strokeStyle = 'blue';\r\n          ctx.lineWidth = lineWidth;\r\n          ctx.stroke();\r\n        }\r\n      });\r\n\r\n      pose.keypoints.forEach((keypoint, index) => {\r\n        const noDraw = index < 10 && index != 2 && index != 5 && index != 9 && index != 10;\r\n        if (keypoint.score > 0.3 && !noDraw) {\r\n          ctx.beginPath();\r\n          ctx.arc(keypoint.x * scaleX, keypoint.y * scaleY, keyPointRadius, 0, 2 * Math.PI);\r\n          ctx.fillStyle = 'blue';\r\n          ctx.fill();\r\n          ctx.strokeStyle = 'yellow'\r\n          ctx.lineWidth = 1;\r\n          ctx.stroke();\r\n        }\r\n      });\r\n    });\r\n\r\n    const angles = calculateAllAngles(pose.keypoints3D, window.groupNameSelected);\r\n    displayAngles(ctx, angles);\r\n\r\n    const remapAngles = angleMapping(angles, window.groups[window.selectedGroup].data);\r\n    lastPoseAngles = remapAngles;\r\n\r\n    if (linkRobot.classList.contains('checked')) {\r\n      Object.keys(window.viewer.robot.joints).slice(0, 6).map((jointName, index) => {\r\n        window.viewer.setJointValue(jointName, Object.entries(remapAngles)[index][1] * DEG2RAD);\r\n      });\r\n    }\r\n  }\r\n\r\n  console.log('estimation');\r\n\r\n  // if (poses.length > 0) {\r\n  //   const pose = poses[0];\r\n  //   pose.keypoints3D.forEach(keypoint => {\r\n  //     if (keypoint.score > 0.3) {\r\n\r\n  //       const [x, y] = project3DTo2D(keypoint.x, keypoint.y, keypoint.z);\r\n  //       ctx.beginPath();\r\n  //       ctx.arc(x * scaleX, y * scaleY, keyPointRadius, 0, 2 * Math.PI);\r\n  //       ctx.fillStyle = 'blue';\r\n  //       ctx.fill();\r\n  //     }\r\n  //   });\r\n  // }\r\n}\r\n\r\nfunction angleMapping(angles, groupData) {\r\n  let angleOut = {};\r\n\r\n  for (let i = 1; i <= 6; i++) {\r\n    const joint = `J${i}`;\r\n    const angle = angles[joint];\r\n    // console.log(groupData[joint])\r\n    const mappingData = groupData[joint].mappingData;\r\n\r\n    if (angle !== undefined && !isNaN(angle)) {\r\n      // Clamp the angle to the range defined in mappingData\r\n      let clampedAngle = Math.max(mappingData.PL, Math.min(mappingData.PR, angle));\r\n\r\n      // Map the angle using the values from mappingData\r\n      angleOut[joint] = map(angle, mappingData.PL, mappingData.PR, mappingData.AHL, mappingData.AHR);\r\n\r\n      if (angleOut[joint] === undefined || isNaN(angleOut[joint]))\r\n        angleOut[joint] = 0;\r\n    } else {\r\n      // If angle is undefined or NaN, use a default value or skip\r\n      angleOut[joint] = 0; // or any other default value\r\n    }\r\n    angleOut[joint] = Math.round(angleOut[joint] * 10) / 10;\r\n  }\r\n  // console.log(angleOut);\r\n  return angleOut;\r\n}\r\n\r\nfunction map(input, in_min, in_max, out_min, out_max) {\r\n  return (input - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;\r\n}\r\n\r\nfunction calculateAllAngles(keypoints3D, groupName = \"default\") {\r\n  const angles = {};\r\n  const group = window.groups.find(g => g.name === groupName);\r\n  if (!group || !group.data) {\r\n    console.error('Group not found or group data is empty');\r\n    return angles;\r\n  }\r\n  Object.entries(group.data).forEach(([key, value]) => {\r\n    if (value == 'none')\r\n      return;\r\n    const points = value.angles.split(',').map(id => id.trim());\r\n\r\n    if (points.length === 3 || points.length === 4) {\r\n      if (points.length === 3) {\r\n        const [a, b, c] = points.map(i => {\r\n          if ([\"OH\", \"DV\", \"RH\", \"IH\", \"UV\", \"LH\"].includes(i)) return i;\r\n          return keypoints3D[parseInt(i)] || { x: 0, y: 0, z: 0, score: 0 };\r\n        });\r\n        if ((a.score > 0.2 && b.score > 0.2) || typeof c === 'string') {\r\n          angles[key] = calculateAngle(a, b, c, undefined, value.is3D);\r\n        } else {\r\n          console.warn(`Low confidence for angle ${key}, skipping calculation`);\r\n        }\r\n      } else if (points.length === 4) {\r\n        // Handle 4-point case\r\n        const [a, b, c, d] = points.map(i => keypoints3D[parseInt(i)] || { x: 0, y: 0, z: 0, score: 0 });\r\n        if (a.score > 0.2 && b.score > 0.2 && c.score > 0.2 && d.score > 0.2) {\r\n          angles[key] = calculateAngle(a, b, c, d);\r\n        } else {\r\n          console.warn(`Low confidence for angle ${key}, skipping calculation`);\r\n        }\r\n      }\r\n    } else {\r\n      console.warn(`Invalid number of points for angle ${key}, expected 3 or 4 but got ${points.length}`);\r\n    }\r\n  });\r\n  return angles;\r\n}\r\n\r\nfunction calculateAngle(A, B, C, D, is3D) {\r\n  if (D === undefined) {\r\n    // Check if we're dealing with 2D or 3D calculation\r\n    const withCoord = typeof C === 'string';\r\n    is3D = is3D || withCoord;\r\n\r\n    // Vector from B to A\r\n    const BA = { x: A.x - B.x, y: A.y - B.y, z: is3D ? (A.z || 0) - (B.z || 0) : 0 };\r\n    // Vector from B to C\r\n    let BC = { x: C.x - B.x, y: C.y - B.y, z: is3D ? (C.z || 0) - (B.z || 0) : 0 };\r\n\r\n    if (withCoord) {\r\n      switch (C) {\r\n        case \"OH\": BC = { x: 0, y: 0, z: -1 }; break;\r\n        case \"DV\": BC = { x: 0, y: -1, z: 0 }; break;\r\n        case \"RH\": BC = { x: 1, y: 0, z: 0 }; break;\r\n        case \"IH\": BC = { x: 0, y: 0, z: 1 }; break;\r\n        case \"UV\": BC = { x: 0, y: 1, z: 0 }; break;\r\n        case \"LH\": BC = { x: -1, y: 0, z: 0 }; break;\r\n        default: throw new Error(`Unknown axis: ${C}`);\r\n      }\r\n    }\r\n\r\n    if (is3D) {\r\n      // 3D calculation\r\n      const angle = calculateAngleBetweenVectors(BA, BC);\r\n      const cross = crossProduct(BA, BC);\r\n      const dot = dotProduct(cross, { x: 0, y: 1, z: 0 }); // Assuming Y is up\r\n      return dot < 0 ? -angle : angle;\r\n    } else {\r\n      // 2D calculation\r\n      return calculateAngle2D(BA, BC);\r\n    }\r\n  } else {\r\n    // 4-point calculation\r\n    // Vector from A to B\r\n    const AB = { x: B.x - A.x, y: B.y - A.y, z: B.z - A.z };\r\n    // Vector from C to D\r\n    const CD = { x: D.x - C.x, y: D.y - C.y, z: D.z - C.z };\r\n\r\n    // Calculate angle between AB and CD vectors\r\n    const dotProduct = AB.x * CD.x + AB.y * CD.y + AB.z * CD.z;\r\n    const magnitudeAB = Math.sqrt(AB.x * AB.x + AB.y * AB.y + AB.z * AB.z);\r\n    const magnitudeCD = Math.sqrt(CD.x * CD.x + CD.y * CD.y + CD.z * CD.z);\r\n\r\n    const angle = Math.acos(dotProduct / (magnitudeAB * magnitudeCD));\r\n    return angle * (180 / Math.PI); // Convert to degrees\r\n  }\r\n}\r\n\r\nfunction calculateAngle2D(v1, v2) {\r\n  const dot = v1.x * v2.x + v1.y * v2.y;\r\n  const det = v1.x * v2.y - v1.y * v2.x;\r\n  const angle = Math.atan2(det, dot) * (180 / Math.PI);\r\n  return Math.abs(angle); // Always return positive angle for 2D\r\n}\r\n\r\nfunction calculateAngleBetweenVectors(v1, v2) {\r\n  // Calculate dot product\r\n  const dotProduct = v1.x * v2.x + v1.y * v2.y + v1.z * v2.z;\r\n\r\n  // Calculate magnitudes\r\n  const magnitudeV1 = Math.sqrt(v1.x * v1.x + v1.y * v1.y + v1.z * v1.z);\r\n  const magnitudeV2 = Math.sqrt(v2.x * v2.x + v2.y * v2.y + v2.z * v2.z);\r\n\r\n  // Calculate angle\r\n  const angle = Math.acos(dotProduct / (magnitudeV1 * magnitudeV2));\r\n  return angle * (180 / Math.PI);\r\n}\r\n\r\nfunction crossProduct(v1, v2) {\r\n  return {\r\n    x: v1.y * v2.z - v1.z * v2.y,\r\n    y: v1.z * v2.x - v1.x * v2.z,\r\n    z: v1.x * v2.y - v1.y * v2.x\r\n  };\r\n}\r\n\r\nfunction dotProduct(v1, v2) {\r\n  return v1.x * v2.x + v1.y * v2.y + v1.z * v2.z;\r\n}\r\n\r\nfunction displayAngles(context, angles) {\r\n  context.font = '14px Arial';\r\n  context.fillStyle = 'white';\r\n  context.strokeStyle = 'black';\r\n  context.lineWidth = 3;\r\n\r\n  let y = 30;\r\n  const text = `Group: ${window.groupNameSelected}`;\r\n  context.strokeText(text, 10, y);\r\n  context.fillText(text, 10, y);\r\n  y += 20;\r\n  for (const [name, angle] of Object.entries(angles)) {\r\n    const text = `${name}: ${angle.toFixed(1)}°`;\r\n    context.strokeText(text, 10, y);\r\n    context.fillText(text, 10, y);\r\n    y += 20;\r\n  }\r\n}\r\n\r\nasync function loadVideo(event) {\r\n  const file = event.target.files[0];\r\n  if (file) {\r\n    video.src = URL.createObjectURL(file);\r\n    loading.style.display = 'block';\r\n    canvas.style.display = 'none';\r\n    selectVideoButton.style.display = 'none';\r\n    await video.play();\r\n    video.pause();\r\n    await generateThumbnails();\r\n    closeButton.style.display = 'flex';\r\n    poseButton.style.display = 'flex';\r\n    event.target.value = '';\r\n    canvas.style.display = 'block';\r\n    canvas.style.pointerEvents = 'auto';\r\n    video.style.display = 'block';\r\n    document.querySelector('.controls').style.display = 'flex';\r\n    resizeCanvas();\r\n    createLowResCanvas();\r\n    estimatePoses();\r\n    window.updateMarkers();\r\n  }\r\n}\r\n\r\nconst playPauseAnimation = document.getElementById('play-pause-animation');\r\n\r\ncanvas.addEventListener('click', togglePlayPause);\r\nvideo.addEventListener('click', togglePlayPause);\r\n\r\nfunction togglePlayPause() {\r\n  if (video.paused) {\r\n    video.play();\r\n    playPauseAnimation.className = 'play-pause-animation play';\r\n  } else {\r\n    video.pause();\r\n    playPauseAnimation.className = 'play-pause-animation pause';\r\n    estimatePoses();\r\n  }\r\n\r\n  playPauseAnimation.style.display = 'block';\r\n  setTimeout(() => {\r\n    playPauseAnimation.style.display = 'none';\r\n  }, 1000);\r\n}\r\n\r\nfunction restart() {\r\n  video.currentTime = 0;\r\n  video.play();\r\n  requestAnimationFrame(estimatePoses);\r\n}\r\n\r\nconst recordDataButton = document.getElementById('record-data');\r\nwindow.jointsData = [];\r\n\r\nrecordDataButton.addEventListener('click', () => {\r\n  if (recordDataButton.classList.contains('active'))\r\n    recordData(lastPoseAngles);\r\n});\r\n\r\nwindow.recordData = (poseAngles) => {\r\n  const currentTime = Math.round(video.currentTime * 100) / 100;\r\n  const newData = { time: currentTime, group: window.groupNameSelected, angles: { ...poseAngles } };\r\n\r\n  let inserted = false;\r\n  let i = 0;\r\n  for (; i < window.jointsData.length; i++) {\r\n    if (currentTime < window.jointsData[i].time) {\r\n      window.jointsData.splice(i, 0, newData);\r\n      inserted = true;\r\n      break;\r\n    }\r\n  }\r\n\r\n  if (!inserted) {\r\n    window.jointsData.push(newData);\r\n  }\r\n\r\n  addMarkerToProgressBar(currentTime);\r\n  window.addFrameCard(i);\r\n}\r\n\r\nwindow.addMarkerToProgressBar = (time) => {\r\n  const progress = (time / video.duration) * 99 + 1;\r\n  const marker = document.createElement('div');\r\n  marker.className = 'progress-marker';\r\n  progressContainer.appendChild(marker);\r\n  marker.style.left = `calc(${progress}% - ${marker.clientWidth / 2}px)`;\r\n  marker.addEventListener('click', (event) => {\r\n    marker.addEventListener('mousedown', (event) => {\r\n      event.stopPropagation();\r\n    });\r\n    event.stopPropagation();\r\n    video.currentTime = time;\r\n    updateProgress();\r\n  });\r\n}\r\n\r\nfunction updateProgress() {\r\n  const progress = (video.currentTime / video.duration) * 99 + 1;\r\n  let thickness = progressThumb.clientWidth;\r\n  progressFilled.style.width = `calc(${progress}% - ${thickness / 2}px)`;\r\n  progressThumb.style.left = `calc(${progress}% - ${thickness / 2}px)`;\r\n  if (poseDetectToggle.classList.contains('checked') || video.paused)\r\n    estimatePoses();\r\n}\r\n\r\nfunction startProgressDrag(e) {\r\n  updateProgressWithEvent(e);\r\n  document.addEventListener('mousemove', updateProgressWithEvent);\r\n  document.addEventListener('mouseup', stopProgressDrag);\r\n  document.body.style.userSelect = 'none';\r\n}\r\n\r\nfunction stopProgressDrag() {\r\n  document.removeEventListener('mousemove', updateProgressWithEvent);\r\n  document.removeEventListener('mouseup', stopProgressDrag);\r\n  document.body.style.userSelect = '';\r\n  if (video.paused) {\r\n    estimatePoses();\r\n  }\r\n}\r\n\r\nfunction updateProgressWithEvent(e) {\r\n  const rect = progressContainer.getBoundingClientRect();\r\n  const x = e.clientX - rect.left;\r\n  const width = rect.width;\r\n  const newTime = (x / width) * video.duration;\r\n  video.currentTime = newTime;\r\n  estimatePoses();\r\n}\r\n\r\nasync function generateThumbnails() {\r\n  const duration = video.duration;\r\n  const thumbnailCount = 20;\r\n  const thumbnailCanvas = document.createElement('canvas');\r\n  const context = thumbnailCanvas.getContext('2d');\r\n\r\n  thumbnailCanvas.width = 160;\r\n  thumbnailCanvas.height = 90;\r\n\r\n  for (let i = 0; i < thumbnailCount; i++) {\r\n    const thumbnailTime = (i / thumbnailCount) * duration;\r\n    await setVideoCurrentTime(video, thumbnailTime);\r\n\r\n    const thumbnailDiv = document.createElement('div');\r\n    thumbnailDiv.className = 'progress-thumbnail';\r\n    thumbnailDiv.style.display = 'none';\r\n    progressContainer.insertBefore(thumbnailDiv, progressFilled);\r\n\r\n    context.drawImage(video, 0, 0, thumbnailCanvas.width, thumbnailCanvas.height);\r\n    thumbnailDiv.style.backgroundImage = `url(${thumbnailCanvas.toDataURL()})`;\r\n  }\r\n\r\n  loading.style.display = 'none';\r\n  const thumbnails = document.querySelectorAll('.progress-thumbnail');\r\n  thumbnails.forEach(thumbnail => thumbnail.style.display = 'block');\r\n\r\n  video.currentTime = 0;\r\n}\r\n\r\nasync function setVideoCurrentTime(video, time) {\r\n  return new Promise(resolve => {\r\n    video.currentTime = time;\r\n    video.addEventListener('seeked', resolve, { once: true });\r\n  });\r\n}\r\n\r\nfunction closeVideo() {\r\n  video.pause();\r\n  video.src = \"\";\r\n  selectVideoButton.style.display = 'flex';\r\n  canvas.style.display = 'none';\r\n  video.style.display = 'none';\r\n  document.querySelector('.controls').style.display = 'none';\r\n  closeButton.style.display = 'none';\r\n  poseButton.style.display = 'none';\r\n  document.querySelector('.modal').style.display = 'none';\r\n  const thumbnails = document.querySelectorAll('.progress-thumbnail');\r\n  thumbnails.forEach(thumbnail => thumbnail.remove());\r\n  progressContainer.querySelectorAll('.progress-marker').forEach(mark => mark.remove());\r\n}\r\n\r\nlet isDragging = false;\r\n\r\nhandle.addEventListener('mousedown', (event) => {\r\n  isDragging = true;\r\n  document.addEventListener('mousemove', onDrag);\r\n  document.addEventListener('mouseup', stopDrag);\r\n  document.body.style.userSelect = 'none';\r\n});\r\n\r\nfunction onDrag(event) {\r\n  if (!isDragging) return;\r\n\r\n  const containerRect = document.querySelector('.container').getBoundingClientRect();\r\n  const newWidth = event.clientX - containerRect.left;\r\n\r\n  if (newWidth > 400 && newWidth < containerRect.width - 400) {\r\n    leftSide.style.width = `${newWidth}px`;\r\n    rightSide.style.width = `${containerRect.width - newWidth}px`;\r\n    resizeCanvas();\r\n  }\r\n}\r\n\r\nfunction stopDrag() {\r\n  isDragging = false;\r\n  document.removeEventListener('mousemove', onDrag);\r\n  document.removeEventListener('mouseup', stopDrag);\r\n  document.body.style.userSelect = '';\r\n}\r\n\r\nwindow.addEventListener('resize', () => {\r\n  resizeCanvas();\r\n  createLowResCanvas();\r\n});\r\n\r\n// async function estimatePoses() {\r\n//   console.log('estimation');\r\n//   if (video.readyState >= 2 && poseNetLoaded) {\r\n//     const lowResContext = lowResCanvas.getContext('2d');\r\n//     lowResContext.drawImage(video, 0, 0, lowResCanvas.width, lowResCanvas.height);\r\n\r\n//     const poses = await detector.estimatePoses(lowResCanvas, {\r\n//       flipHorizontal: false\r\n//     });\r\n//     drawPoses(poses);\r\n//   }\r\n//   if (!video.paused) {\r\n//     requestAnimationFrame(estimatePoses);\r\n//   }\r\n// }\r\n\r\nlet lastProcessedTime = 0;\r\nconst processingInterval = 10;\r\n\r\nlet estimationCount = 0;\r\nconst maxEstimations = 5;\r\n\r\nconst updatePose = document.getElementById('update-pose');\r\nupdatePose.addEventListener('click', () => {\r\n  estimatePoses();\r\n});\r\n\r\nasync function estimatePoses(refresh) {\r\n  if (poseDetectToggle.classList.contains('checked') && video.readyState >= 2 && poseNetLoaded || refresh) {\r\n    const currentTime = video.currentTime;\r\n    if (currentTime !== lastProcessedTime || refresh) {\r\n      lastProcessedTime = currentTime;\r\n      const poses = await detectPose(detector, video);\r\n      drawPoses(poses);\r\n    }\r\n  }\r\n}\r\n\r\nfunction periodicPoseEstimation() {\r\n  if (poseDetectToggle.classList.contains('checked') && !video.paused) {\r\n    estimatePoses();\r\n  }\r\n  setTimeout(periodicPoseEstimation, processingInterval);\r\n}\r\n\r\nposeButton.addEventListener('click', () => {\r\n  const poseList = document.querySelectorAll('.field');\r\n  poseList.forEach((e, index) => {\r\n    e.innerHTML = `${angleDefinitions[index].name}: ${angleDefinitions[index].points}`;\r\n  });\r\n\r\n  document.querySelector('.modal').style.zIndex = '1000';\r\n  document.querySelector('.modal').classList.toggle('show');\r\n  document.querySelector('.overlay').classList.toggle('show');\r\n});\r\ndocument.querySelector('.overlay').addEventListener('click', () => {\r\n  document.querySelector('.modal').classList.remove('show');\r\n  document.querySelector('.overlay').classList.remove('show');\r\n  setTimeout(() => {\r\n    document.querySelector('.modal').style.zIndex = '-1';\r\n  }, 500);\r\n});\r\n\r\n// Video Controls with Time Display\r\nconst currentTimeEl = document.getElementById('current-time');\r\nconst totalTimeEl = document.getElementById('total-time');\r\n\r\nvideo.addEventListener('timeupdate', () => {\r\n  currentTimeEl.textContent = formatTime(video.currentTime);\r\n  updateProgress();\r\n  if (video.paused) {\r\n    estimatePoses();\r\n  }\r\n});\r\n\r\nfunction formatTime(seconds) {\r\n  const minutes = Math.floor(seconds / 60);\r\n  const remainingSeconds = Math.floor(seconds % 60);\r\n  return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;\r\n}\r\n\r\ndocument.addEventListener('keyup', function (event) {\r\n  if (event.key === 'Tab') {\r\n    event.preventDefault();\r\n    if (poseDetectToggle.classList.contains('checked'))\r\n      recordData(lastPoseAngles);\r\n  }\r\n});\r\n\r\ndocument.addEventListener('keydown', function (event) {\r\n  if (event.key === 'Tab') {\r\n    event.preventDefault();\r\n  }\r\n});"]}