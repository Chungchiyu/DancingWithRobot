{"version":3,"sources":["src/human.js"],"names":["figure","document","getElementById","svg","nodes","id","x","y","connections","selectedPoints","useExteriorAngle","selectedCoordinateLine","showCoordinateSystem","selectedButton","drawDashedEllipse","style","zIndex","forEach","createNode","_ref","_ref2","_slicedToArray","startId","endId","start","find","n","end","createLine","node","element","createElement","className","setAttribute","left","concat","top","textContent","addEventListener","e","stopPropagation","selectNode","appendChild","line","length","Math","sqrt","pow","angle","atan2","width","transform","index","findIndex","p","splice","classList","remove","removedNode","shift","querySelector","push","add","updateAngle","calculateAngle","p1","p2","p3","v1","v2","dotProduct","v1Mag","v2Mag","cosAngle","clampedCosAngle","max","min","acos","createSVGElement","type","createElementNS","ellipse","drawCoordinateSystem","size","angles","PI","labels","virtualPoints","label","cos","sin","virtualLabel","transition","hitBox","opacity","endX","parseFloat","getAttribute","endY","virtualPoint","toggleButton","button3D","button2D","disabled","innerHTML","_selectedPoints","_selectedPoints2","point","coordinateLine","_selectedPoints3","_selectedPoints4","line2","interiorAngle","exteriorAngle","drawAngle","_selectedPoints5","_selectedPoints6","p4","line1","color","isExteriorAngle","radius","startAngle","endAngle","sweepFlag","largeArcFlag","path","d","savedAngles","Array","fill","_loop","i","button","querySelectorAll","selectAngleButton","updateButton","position","right","bottom","saveAngle","saveMappingData","groups","selectedGroup","data","is3D","window","saveLocalData","loadAngleFromButtonContent","content","pointIds","split","map","trim","includes","parseInt","highlightSelectedNodes","angleData","updateButtonLabel","alert","newAngleData","angleDataString","_typeof","join","isArray","console","error","prevButton","currentAngleData","clearFigure","loadAngle","buttonContent","updateMappingData","mappingData","updateIs3D","some","r","log","addGroup","groupNameSelected","initGroups","defaultAxisValues","J1","PL","PR","AL","AR","PHL","PHR","AHL","AHR","J2","J3","J4","J5","J6","defaultGroup","name","angleCards","card","_objectSpread","updateGroups","value","groupData","cardContent","groupsContainer","group","target","contains","selectGroup","deleteBtn","clickTimer","clickCount","setTimeout","confirm","deleteGroup","clearTimeout","enableGroupNameEdit","prevGroupCard","groupCard","postureSlider","setBounds","setValues","armSlider","currentJoint","currentData","leftBound","rightBound","output","resetMappingData","Object","assign","posture","arm","updateSliders","groupIndex","contentDiv","currentName","input","boxSizing","padding","border","backgroundColor","font","focus","finishEdit","key","newName","NumericRangeSlider","container","options","_classCallCheck","leftInput","previousElementSibling","rightInput","nextElementSibling","values","step","onChange","dragging","init","_createClass","_this","range","handles","handle","startDragging","bind","updateFromInput","updateHandles","preventDefault","drag","stopDragging","removeEventListener","rect","getBoundingClientRect","clientX","snappedValue","round","leftOrigin","rightOrigin","minor","major","_this2","leftPosition","rightPosition","_this3","buttonSlider","toggle"],"mappings":"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","file":"human.a77fcb94.js","sourceRoot":"..","sourcesContent":["const figure = document.getElementById('figure');\r\nconst svg = document.getElementById('svgLayer');\r\nconst nodes = [\r\n    { id: 0, x: 150, y: 50 },\r\n    { id: 1, x: 158, y: 30 }, { id: 2, x: 165, y: 30 }, { id: 3, x: 172, y: 30 },\r\n    { id: 4, x: 142, y: 30 }, { id: 5, x: 135, y: 30 }, { id: 6, x: 128, y: 30 },\r\n    { id: 7, x: 185, y: 40 }, { id: 8, x: 115, y: 40 },\r\n    { id: 9, x: 160, y: 70 }, { id: 10, x: 140, y: 70 },\r\n    { id: 11, x: 200, y: 105 }, { id: 12, x: 100, y: 105 },\r\n    { id: 13, x: 225, y: 130 }, { id: 14, x: 75, y: 130 },\r\n    { id: 15, x: 250, y: 115 }, { id: 16, x: 50, y: 115 },\r\n    { id: 17, x: 270, y: 117 }, { id: 18, x: 30, y: 117 },\r\n    { id: 19, x: 263, y: 97 }, { id: 20, x: 37, y: 97 },\r\n    { id: 21, x: 247, y: 102 }, { id: 22, x: 53, y: 102 },\r\n    { id: 23, x: 185, y: 200 }, { id: 24, x: 115, y: 200 },\r\n    { id: 25, x: 195, y: 290 }, { id: 26, x: 105, y: 290 },\r\n    { id: 27, x: 185, y: 380 }, { id: 28, x: 115, y: 380 },\r\n    { id: 29, x: 175, y: 400 }, { id: 30, x: 125, y: 400 },\r\n    { id: 31, x: 220, y: 405 }, { id: 32, x: 80, y: 405 }\r\n];\r\nconst connections = [\r\n    [0, 2], [0, 5], [7, 2], [8, 5], [9, 10], [11, 12], [13, 11],\r\n    [14, 12], [15, 13], [16, 14], [16, 20], [17, 15], [18, 16],\r\n    [19, 17], [15, 19], [20, 18], [21, 15], [22, 16], [23, 11],\r\n    [24, 12], [24, 23], [25, 23], [26, 24], [27, 25], [28, 26],\r\n    [29, 27], [30, 28], [31, 29], [32, 30], [28, 32], [27, 31]\r\n];\r\nlet selectedPoints = [];\r\nlet useExteriorAngle = false;\r\nlet selectedCoordinateLine = null;\r\nlet showCoordinateSystem = false;\r\nlet selectedButton = null;\r\n\r\n// Initial draw of the dashed ellipse\r\ndrawDashedEllipse();\r\n\r\n// Modify the CSS for the SVG layer to ensure it's always on top\r\nsvg.style.zIndex = '9999';\r\n\r\n// Create nodes and connections\r\nnodes.forEach(createNode);\r\nconnections.forEach(([startId, endId]) => {\r\n    const start = nodes.find(n => n.id === startId);\r\n    const end = nodes.find(n => n.id === endId);\r\n    createLine(start, end);\r\n});\r\n\r\nfunction createNode(node) {\r\n    const element = document.createElement('div');\r\n    element.className = 'node';\r\n    element.setAttribute('id', node.id);\r\n    element.style.left = `${node.x - 5}px`;\r\n    element.style.top = `${node.y - 5}px`;\r\n    element.textContent = node.id;\r\n    element.addEventListener('click', (e) => {\r\n        e.stopPropagation();\r\n        selectNode(node, element);\r\n    });\r\n    figure.appendChild(element);\r\n}\r\n\r\nfunction createLine(start, end) {\r\n    const line = document.createElement('div');\r\n    line.className = 'line';\r\n    const length = Math.sqrt((end.x - start.x) ** 2 + (end.y - start.y) ** 2);\r\n    const angle = Math.atan2(end.y - start.y, end.x - start.x);\r\n    line.style.width = `${length}px`;\r\n    line.style.left = `${start.x}px`;\r\n    line.style.top = `${start.y}px`;\r\n    line.style.transform = `rotate(${angle}rad)`;\r\n    figure.appendChild(line);\r\n}\r\n\r\nfunction selectNode(node, element) {\r\n    const index = selectedPoints.findIndex(p => p.id === node.id);\r\n    if (index !== -1) {\r\n        selectedPoints.splice(index, 1);\r\n        element.classList.remove('selected');\r\n    } else {\r\n        if (selectedPoints.length >= 4) {\r\n            const removedNode = selectedPoints.shift();\r\n            document.querySelector(`.node:nth-child(${removedNode.id + 1})`).classList.remove('selected');\r\n        }\r\n        selectedPoints.push(node);\r\n        element.classList.add('selected');\r\n    }\r\n    showCoordinateSystem = selectedPoints.length === 2;\r\n    updateAngle();\r\n}\r\n\r\nfunction calculateAngle(p1, p2, p3) {\r\n    const v1 = { x: p1.x - p2.x, y: p1.y - p2.y };\r\n    const v2 = { x: p3.x - p2.x, y: p3.y - p2.y };\r\n    const dotProduct = v1.x * v2.x + v1.y * v2.y;\r\n    const v1Mag = Math.sqrt(v1.x * v1.x + v1.y * v1.y);\r\n    const v2Mag = Math.sqrt(v2.x * v2.x + v2.y * v2.y);\r\n    const cosAngle = dotProduct / (v1Mag * v2Mag);\r\n    const clampedCosAngle = Math.max(-1, Math.min(1, cosAngle));\r\n    return Math.acos(clampedCosAngle);\r\n}\r\n\r\nfunction createSVGElement(type) {\r\n    return document.createElementNS(\"http://www.w3.org/2000/svg\", type);\r\n}\r\n\r\nfunction drawDashedEllipse() {\r\n    const ellipse = createSVGElement('ellipse');\r\n    ellipse.setAttribute('cx', '150');\r\n    ellipse.setAttribute('cy', '50');\r\n    ellipse.setAttribute('rx', '40');\r\n    ellipse.setAttribute('ry', '45');\r\n    ellipse.setAttribute('fill', 'none');\r\n    ellipse.setAttribute('stroke', 'black');\r\n    ellipse.setAttribute('stroke-width', '2');\r\n    ellipse.setAttribute('stroke-dasharray', '5,5');\r\n    svg.appendChild(ellipse);\r\n}\r\n\r\nfunction drawCoordinateSystem(x, y) {\r\n    const size = 50;\r\n    const angles = [0, -Math.PI / 4, -Math.PI / 2, Math.PI / 2, Math.PI, 3 * Math.PI / 4];\r\n    const labels = ['RH', 'IH', 'UV', 'DV', 'LH', 'OH'];\r\n\r\n    // Create a map of virtual points\r\n    const virtualPoints = {};\r\n    labels.forEach((label, index) => {\r\n        virtualPoints[label] = {\r\n            x: x + size * Math.cos(angles[index]),\r\n            y: y + size * Math.sin(angles[index]),\r\n            id: label\r\n        };\r\n    });\r\n\r\n    // Check if we need to use a virtual point\r\n    if (selectedPoints.length === 3 && typeof selectedPoints[2].id === 'string') {\r\n        const virtualLabel = selectedPoints[2].id;\r\n        if (virtualPoints[virtualLabel]) {\r\n            selectedPoints[2] = virtualPoints[virtualLabel];\r\n        }\r\n    }\r\n\r\n    angles.forEach((angle, index) => {\r\n        const line = createSVGElement('line');\r\n        line.setAttribute('x1', x);\r\n        line.setAttribute('y1', y);\r\n        line.setAttribute('x2', x + size * Math.cos(angle));\r\n        line.setAttribute('y2', y + size * Math.sin(angle));\r\n        line.setAttribute('stroke', 'green');\r\n        line.setAttribute('stroke-width', '2');\r\n        line.setAttribute('stroke-dasharray', '5,5');\r\n        line.setAttribute('data-label', labels[index]);\r\n        line.style.transition = 'all 0.3s ease';\r\n\r\n        const hitBox = createSVGElement('line');\r\n        hitBox.setAttribute('x1', x);\r\n        hitBox.setAttribute('y1', y);\r\n        hitBox.setAttribute('x2', x + size * Math.cos(angle));\r\n        hitBox.setAttribute('y2', y + size * Math.sin(angle));\r\n        hitBox.setAttribute('stroke', 'transparent');\r\n        hitBox.setAttribute('stroke-width', '10');\r\n\r\n        const label = createSVGElement('text');\r\n        label.setAttribute('x', x + (size + 10) * Math.cos(angle));\r\n        label.setAttribute('y', y + (size + 10) * Math.sin(angle));\r\n        label.setAttribute('fill', 'green');\r\n        label.setAttribute('text-anchor', 'middle');\r\n        label.setAttribute('dominant-baseline', 'middle');\r\n        label.textContent = labels[index];\r\n        label.style.opacity = '1';\r\n\r\n        hitBox.addEventListener('mouseover', () => {\r\n            line.setAttribute('stroke', 'red');\r\n            line.setAttribute('stroke-width', '2');\r\n            // label.style.opacity = '1';\r\n        });\r\n\r\n        hitBox.addEventListener('mouseout', () => {\r\n            if (selectedCoordinateLine !== line) {\r\n                line.setAttribute('stroke', 'green');\r\n                line.setAttribute('stroke-width', '2');\r\n            }\r\n            // label.style.opacity = '0';\r\n        });\r\n\r\n        hitBox.addEventListener('click', (e) => {\r\n            e.stopPropagation();\r\n            if (selectedCoordinateLine) {\r\n                selectedCoordinateLine.setAttribute('stroke', 'black');\r\n                selectedCoordinateLine.setAttribute('stroke-width', '1');\r\n            }\r\n            line.setAttribute('stroke', 'blue');\r\n            line.setAttribute('stroke-width', '2');\r\n            selectedCoordinateLine = line;\r\n\r\n            const endX = parseFloat(line.getAttribute('x2'));\r\n            const endY = parseFloat(line.getAttribute('y2'));\r\n            const virtualPoint = { x: endX, y: endY, id: labels[index] };\r\n            selectNode(virtualPoint, { classList: { add: () => { }, remove: () => { } } });\r\n\r\n            toggleButton(button3D);\r\n            button2D.disabled = true;\r\n        });\r\n\r\n        svg.appendChild(line);\r\n        svg.appendChild(hitBox);\r\n        svg.appendChild(label);\r\n    });\r\n}\r\n\r\nfunction updateAngle() {\r\n    svg.innerHTML = '';\r\n\r\n    drawDashedEllipse();\r\n\r\n    if (selectedPoints.length >= 2) {\r\n        const [p1, p2] = selectedPoints;\r\n        const line = createSVGElement('line');\r\n        line.setAttribute('x1', p1.x);\r\n        line.setAttribute('y1', p1.y);\r\n        line.setAttribute('x2', p2.x);\r\n        line.setAttribute('y2', p2.y);\r\n        line.setAttribute('stroke', 'blue');\r\n        line.setAttribute('stroke-width', '6');\r\n        svg.appendChild(line);\r\n\r\n        if (selectedPoints.length < 3 || typeof selectedPoints[2].id !== 'number') {\r\n            drawCoordinateSystem(p2.x, p2.y);\r\n\r\n            // Highlight saved coordinate lines\r\n            selectedPoints.forEach(point => {\r\n                if (typeof point.id === 'string') {\r\n                    const coordinateLine = svg.querySelector(`line[data-label=\"${point.id}\"]`);\r\n                    if (coordinateLine) {\r\n                        coordinateLine.setAttribute('stroke', 'blue');\r\n                        coordinateLine.setAttribute('stroke-width', '2');\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    if (selectedPoints.length === 3) {\r\n        const [p1, p2, p3] = selectedPoints;\r\n        const line2 = createSVGElement('line');\r\n        line2.setAttribute('x1', p2.x);\r\n        line2.setAttribute('y1', p2.y);\r\n        line2.setAttribute('x2', p3.x);\r\n        line2.setAttribute('y2', p3.y);\r\n        line2.setAttribute('stroke', 'blue');\r\n        line2.setAttribute('stroke-width', '6');\r\n        svg.appendChild(line2);\r\n\r\n        const interiorAngle = calculateAngle(p1, p2, p3);\r\n        const exteriorAngle = 2 * Math.PI - interiorAngle;\r\n        drawAngle(p1, p2, p3, interiorAngle, 'red', false);\r\n        drawAngle(p1, p2, p3, exteriorAngle, 'blue', true);\r\n    } else if (selectedPoints.length === 4) {\r\n        const [p1, p2, p3, p4] = selectedPoints;\r\n\r\n        // Draw first line\r\n        const line1 = createSVGElement('line');\r\n        line1.setAttribute('x1', p1.x);\r\n        line1.setAttribute('y1', p1.y);\r\n        line1.setAttribute('x2', p2.x);\r\n        line1.setAttribute('y2', p2.y);\r\n        line1.setAttribute('stroke', 'blue');\r\n        line1.setAttribute('stroke-width', '6');\r\n        svg.appendChild(line1);\r\n\r\n        // Draw second line\r\n        const line2 = createSVGElement('line');\r\n        line2.setAttribute('x1', p3.x);\r\n        line2.setAttribute('y1', p3.y);\r\n        line2.setAttribute('x2', p4.x);\r\n        line2.setAttribute('y2', p4.y);\r\n        line2.setAttribute('stroke', 'green');\r\n        line2.setAttribute('stroke-width', '6');\r\n        svg.appendChild(line2);\r\n    }\r\n}\r\n\r\nfunction drawAngle(p1, p2, p3, angle, color, isExteriorAngle) {\r\n    if (isExteriorAngle && !useExteriorAngle) return;\r\n    if (!isExteriorAngle && useExteriorAngle) return;\r\n\r\n    const radius = 30;\r\n    const startAngle = Math.atan2(p1.y - p2.y, p1.x - p2.x);\r\n    const endAngle = Math.atan2(p3.y - p2.y, p3.x - p2.x);\r\n\r\n    const start = {\r\n        x: p2.x + radius * Math.cos(startAngle),\r\n        y: p2.y + radius * Math.sin(startAngle)\r\n    };\r\n    const end = {\r\n        x: p2.x + radius * Math.cos(endAngle),\r\n        y: p2.y + radius * Math.sin(endAngle)\r\n    };\r\n\r\n    let sweepFlag = 1;\r\n    if ((endAngle - startAngle + 2 * Math.PI) % (2 * Math.PI) > Math.PI) {\r\n        sweepFlag = isExteriorAngle ? 1 : 0;\r\n    } else {\r\n        sweepFlag = isExteriorAngle ? 0 : 1;\r\n    }\r\n\r\n    const largeArcFlag = angle > Math.PI ? 1 : 0;\r\n    const path = createSVGElement('path');\r\n    const d = `M ${start.x} ${start.y} A ${radius} ${radius} 0 ${largeArcFlag} ${sweepFlag} ${end.x} ${end.y} L ${p2.x} ${p2.y} Z`;\r\n    path.setAttribute('d', d);\r\n    path.setAttribute('fill', `rgba(${color === 'red' ? '255,0,0' : '0,0,255'}, 0.2)`);\r\n    path.setAttribute('stroke', color);\r\n\r\n    path.addEventListener('click', (e) => {\r\n        e.stopPropagation();\r\n        useExteriorAngle = !useExteriorAngle;\r\n        updateAngle();\r\n    });\r\n\r\n    svg.appendChild(path);\r\n\r\n    // const text = createSVGElement('text');\r\n    // const labelRadius = 50;\r\n    // const labelAngle = (startAngle + endAngle) / 2;\r\n    // text.setAttribute('x', p2.x + labelRadius * Math.cos(labelAngle));\r\n    // text.setAttribute('y', p2.y + labelRadius * Math.sin(labelAngle));\r\n    // text.setAttribute('font-size', '14px');\r\n    // text.setAttribute('fill', color);\r\n    // text.setAttribute('text-anchor', 'middle');\r\n    // text.textContent = `${(angle * 180 / Math.PI).toFixed(2)}°`;\r\n\r\n    // svg.appendChild(text);\r\n}\r\n\r\n// Create save buttons\r\nconst savedAngles = Array(6).fill(null);\r\nfor (let i = 0; i < 6; i++) {\r\n    const button = document.querySelectorAll('.angleCard');\r\n    button[i].addEventListener('click', (e) => {\r\n        e.stopPropagation();\r\n        selectAngleButton(i);\r\n    });\r\n}\r\n\r\n// Create update button\r\nconst updateButton = document.createElement('button');\r\nupdateButton.textContent = 'Update';\r\nupdateButton.style.position = 'absolute';\r\nupdateButton.style.right = '10px';\r\nupdateButton.style.bottom = '10px';\r\nupdateButton.addEventListener('click', (e) => {\r\n    e.stopPropagation();\r\n    saveAngle();\r\n    saveMappingData();\r\n    updateButton.textContent = 'saved';\r\n    groups[selectedGroup].data[`J${selectedButton + 1}`].is3D = is3D;\r\n    window.saveLocalData();\r\n});\r\nfigure.appendChild(updateButton);\r\n\r\nfunction loadAngleFromButtonContent(content) {\r\n    // Parse the content and load the angle\r\n    const pointIds = content.split(',').map(id => id.trim());\r\n    selectedPoints = pointIds.map(id => {\r\n        if (['RH', 'IH', 'UV', 'DV', 'LH', 'OH'].includes(id)) {\r\n            // For coordinate lines\r\n            return { id: id, x: 0, y: 0 }; // Coordinates will be set in updateAngle\r\n        } else {\r\n            return nodes.find(n => n.id === parseInt(id));\r\n        }\r\n    });\r\n    updateAngle();\r\n    highlightSelectedNodes();\r\n}\r\n\r\n// Define angleData at the top level of your script\r\nlet angleData = Array(6).fill(null);\r\n\r\nfunction saveAngle() {\r\n    if (selectedPoints.length == 0) {\r\n        updateButtonLabel(selectedButton, 'none');\r\n        groups[selectedGroup].data[`J${selectedButton + 1}`].angles = 'none';\r\n        return;\r\n    } else if (selectedPoints.length < 3) {\r\n        alert('Please select at least three points or coordinate positions to save an angle.');\r\n        return;\r\n    }\r\n    if (selectedButton === null) {\r\n        alert('Please select an angle button to save the angle.');\r\n        return;\r\n    }\r\n    const newAngleData = selectedPoints.map(p => {\r\n        if (typeof p.id === 'string') {\r\n            // For coordinate lines, store the line details\r\n            return { id: p.id, x: p.x, y: p.y };\r\n        }\r\n        return p.id;\r\n    });\r\n\r\n    let angleDataString;// = (button2D.classList.contains('active') ? '2D' : '3D') + ',';\r\n    angleDataString = newAngleData.map(p => typeof p === 'object' ? p.id : p).join(',');\r\n\r\n    if (groups.length > 0 && selectedGroup !== null) {\r\n        // If groups exist and one is selected, save to the selected group\r\n        groups[selectedGroup].data[`J${selectedButton + 1}`].angles = angleDataString;\r\n    } else {\r\n        // If no groups exist or no group is selected, save to angleData\r\n        angleData[selectedButton] = newAngleData;\r\n    }\r\n\r\n    updateButtonLabel(selectedButton, angleDataString);\r\n}\r\n\r\nfunction updateButtonLabel(index, angleData) {\r\n    const button = document.querySelector(`.angleCard:nth-of-type(${index + 1})`);\r\n    if (angleData === 'none') {\r\n        button.querySelector('.angleCard-content').textContent = 'none';\r\n    } else if (typeof angleData === 'string') {\r\n        button.querySelector('.angleCard-content').textContent = angleData;\r\n    } else if (Array.isArray(angleData)) {\r\n        button.querySelector('.angleCard-content').textContent = angleData.map(p => typeof p === 'object' ? p.id : p).join(',');\r\n    } else {\r\n        console.error('Unexpected angleData format:', angleData);\r\n        button.querySelector('.angleCard-content').textContent = 'Error';\r\n    }\r\n}\r\n\r\nfunction selectAngleButton(index) {\r\n    updateButton.textContent = 'update';\r\n    if (selectedButton !== null) {\r\n        const prevButton = document.querySelector(`.angleCard:nth-of-type(${selectedButton + 1})`);\r\n        prevButton.classList.remove('selected');\r\n    }\r\n    selectedButton = index;\r\n    const button = document.querySelector(`.angleCard:nth-of-type(${index + 1})`);\r\n    button.classList.add('selected');\r\n\r\n    let currentAngleData;\r\n    if (groups.length > 0 && selectedGroup !== null) {\r\n        // If groups exist and one is selected, load from the selected group\r\n        currentAngleData = groups[selectedGroup].data[`J${index + 1}`].angles;\r\n    } else {\r\n        // If no groups exist or no group is selected, load from angleData\r\n        currentAngleData = angleData[index].angles;\r\n    }\r\n\r\n    if (currentAngleData) {\r\n        if (typeof currentAngleData === 'string') {\r\n            if (currentAngleData == 'none')\r\n                clearFigure();\r\n            else\r\n                loadAngleFromButtonContent(currentAngleData);\r\n        } else if (Array.isArray(currentAngleData)) {\r\n            loadAngle(currentAngleData);\r\n        } else {\r\n            console.error('Unexpected angleData format:', currentAngleData);\r\n            clearFigure();\r\n        }\r\n    } else {\r\n        // Load angle data from button content if no data in groups or angleData\r\n        const buttonContent = button.querySelector('.angleCard-content').textContent.trim();\r\n        if (buttonContent !== 'none') {\r\n            loadAngleFromButtonContent(buttonContent);\r\n        } else {\r\n            clearFigure(); // Clear the figure if content is 'none'\r\n        }\r\n    }\r\n\r\n    updateMappingData(groups[selectedGroup].data[`J${index + 1}`].mappingData);\r\n    updateIs3D();\r\n\r\n    if (['RH', 'IH', 'UV', 'DV', 'LH', 'OH'].some(r=> currentAngleData.includes(r)))\r\n        button2D.disabled = true;\r\n}\r\n\r\nfunction loadAngle(angleData) {\r\n    selectedPoints = angleData.map(point => {\r\n        if (typeof point === 'object') {\r\n            // For coordinate lines\r\n            return point;\r\n        } else {\r\n            return nodes.find(n => n.id === point);\r\n        }\r\n    });\r\n    console.log(selectedPoints);\r\n    updateAngle();\r\n    highlightSelectedNodes();\r\n}\r\n\r\nfunction highlightSelectedNodes() {\r\n    // Remove highlight from all nodes\r\n    document.querySelectorAll('.node').forEach(node => {\r\n        node.classList.remove('selected');\r\n    });\r\n    // Highlight selected nodes\r\n    selectedPoints.forEach(point => {\r\n        if (!point) return;\r\n        if (typeof point.id === 'number') {\r\n            document.getElementById(point.id).classList.add('selected');\r\n        }\r\n    });\r\n}\r\n\r\n// Add click event to figure to deselect all nodes\r\nfigure.addEventListener('click', () => {\r\n    clearFigure();\r\n});\r\n\r\nfunction clearFigure() {\r\n    document.querySelectorAll('.node').forEach(node => {\r\n        node.classList.remove('selected');\r\n    });\r\n    selectedPoints = [];\r\n    useExteriorAngle = false;\r\n    selectedCoordinateLine = null;\r\n    showCoordinateSystem = false;\r\n    updateAngle();\r\n\r\n    toggleButton(button2D);\r\n}\r\n\r\ndocument.getElementById('addGroupBtn').addEventListener('click', addGroup);\r\n\r\nwindow.groups = [];\r\nwindow.selectedGroup = null;\r\nwindow.groupNameSelected = 'default';\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    initGroups();\r\n});\r\n\r\n// Define default values for each axis\r\nconst defaultAxisValues = {\r\n    J1: { PL: -90, PR: 90, AL: -110, AR: 110, PHL: -90, PHR: 90, AHL: -110, AHR: 110 },\r\n    J2: { PL: 0, PR: 60, AL: -50, AR: 0, PHL: 0, PHR: 60, AHL: -50, AHR: 0 },\r\n    J3: { PL: 0, PR: 180, AL: -80, AR: 90, PHL: 0, PHR: 180, AHL: -80, AHR: 90 },\r\n    J4: { PL: 0, PR: 0, AL: 0, AR: 0, PHL: 0, PHR: 0, AHL: 0, AHR: 0 }, // J4 is always 0\r\n    J5: { PL: 90, PR: 180, AL: -90, AR: 0, PHL: 90, PHR: 180, AHL: -90, AHR: 0 },\r\n    J6: { PL: 0, PR: 0, AL: 0, AR: 0, PHL: 0, PHR: 0, AHL: 0, AHR: 0 }  // J6 is always 0\r\n};\r\n\r\nconst initGroups = () => {\r\n    const defaultGroup = { name: 'default', data: {} };\r\n    const angleCards = document.querySelectorAll('.angleCard.AC');\r\n    angleCards.forEach((card, index) => {\r\n        const content = card.querySelector('.angleCard-content').textContent.trim();\r\n        defaultGroup.data[`J${index + 1}`] = {\r\n            angles: content,\r\n            mappingData: { ...defaultAxisValues[`J${index + 1}`] },\r\n            is3D: ['RH', 'IH', 'UV', 'DV', 'LH', 'OH'].some(r=> content.includes(r))\r\n        };\r\n    });\r\n    groups.push(defaultGroup);\r\n    updateGroups();\r\n}\r\n\r\nfunction addGroup() {\r\n    let name = document.getElementById('newGroupName').value.trim();\r\n    if (name === '') {\r\n        name = 'default';\r\n    }\r\n\r\n    const groupData = {};\r\n    for (let i = 1; i <= 6; i++) {\r\n        const cardContent = document.querySelector(`.angleCard:nth-of-type(${i}) .angleCard-content`).textContent;\r\n        groupData[`J${i}`] = {\r\n            angles: cardContent,\r\n            mappingData: { ...defaultAxisValues[`J${i}`] },\r\n            is3D: false\r\n        };\r\n    }\r\n\r\n    groups.push({ name, data: groupData });\r\n    updateGroups();\r\n    document.getElementById('newGroupName').value = '';\r\n}\r\n\r\nwindow.updateGroups = function () {\r\n    const groupsContainer = document.getElementById('groups-container');\r\n    groupsContainer.innerHTML = '';\r\n    groups.forEach((group, index) => {\r\n        const card = document.createElement('div');\r\n        card.className = 'angleCard group-card';\r\n        card.innerHTML = `\r\n        <div class=\"angleCard-label\">G${index + 1}</div>\r\n        <div class=\"angleCard-content\">${group.name}</div>\r\n        ${index !== 0 ? '<span class=\"delete-group\">X</span>' : ''}\r\n      `;\r\n        card.addEventListener('click', (e) => {\r\n            if (!e.target.classList.contains('delete-group')) {\r\n                selectGroup(index);\r\n            }\r\n        });\r\n\r\n        if (index !== 0) {\r\n            const deleteBtn = card.querySelector('.delete-group');\r\n            let clickTimer = null;\r\n            let clickCount = 0;\r\n\r\n            deleteBtn.addEventListener('click', (e) => {\r\n                e.stopPropagation();\r\n                clickCount++;\r\n\r\n                if (clickCount === 1) {\r\n                    clickTimer = setTimeout(() => {\r\n                        if (clickCount === 1) {\r\n                            // Single click\r\n                            if (confirm(`確定要刪除群組 \"${group.name}\" 嗎？`)) {\r\n                                deleteGroup(index);\r\n                            }\r\n                        }\r\n                        clickCount = 0;\r\n                    }, 300); // Adjust this delay as needed\r\n                } else if (clickCount === 2) {\r\n                    // Double click\r\n                    clearTimeout(clickTimer);\r\n                    deleteGroup(index);\r\n                    clickCount = 0;\r\n                }\r\n            });\r\n        }\r\n\r\n        enableGroupNameEdit(card, index);\r\n        groupsContainer.appendChild(card);\r\n    });\r\n\r\n    if (groups.length === 1) {\r\n        selectGroup(0);\r\n    } else {\r\n        selectGroup(selectedGroup);\r\n    }\r\n\r\n    window.saveLocalData();\r\n}\r\n\r\nfunction deleteGroup(index) {\r\n    if (index === 0) {\r\n        alert(\"無法刪除預設群組。\");\r\n        return;\r\n    }\r\n\r\n    groups.splice(index, 1);\r\n    if (selectedGroup === index) {\r\n        selectedGroup--;\r\n    }\r\n    updateGroups();\r\n}\r\n\r\nwindow.selectGroup = (index) => {\r\n    if (selectedGroup !== null) {\r\n        const prevGroupCard = document.querySelector(`#groups-container .angleCard:nth-child(${selectedGroup + 1})`);\r\n        prevGroupCard.classList.remove('selected');\r\n    }\r\n    selectedGroup = index;\r\n    const group = groups[index];\r\n    const groupCard = document.querySelector(`#groups-container .angleCard:nth-child(${index + 1})`);\r\n    groupCard.classList.add('selected');\r\n    groupNameSelected = group.name;\r\n\r\n    if (group && group.data) {\r\n        for (let i = 1; i <= 6; i++) {\r\n            const card = document.querySelector(`.angleCard:nth-of-type(${i})`);\r\n            const content = group.data[`J${i}`].angles || 'none';\r\n            card.querySelector('.angleCard-content').textContent = content;\r\n        }\r\n        // Update mappingData for the selected joint (assuming we're working with J1)\r\n        updateMappingData(group.data.J1.mappingData);\r\n    }\r\n    selectAngleButton(0);\r\n}\r\n\r\nwindow.updateMappingData = (data) => {\r\n    if (!data) return;\r\n\r\n    postureSlider.setBounds(data.PL, data.PR);\r\n    postureSlider.setValues([data.PHL, data.PHR]);\r\n\r\n    armSlider.setBounds(data.AL, data.AR);\r\n    armSlider.setValues([data.AHL, data.AHR]);\r\n}\r\n\r\nwindow.saveMappingData = () => {\r\n    if (selectedGroup === null || !groups[selectedGroup]) return;\r\n\r\n    const currentJoint = `J${selectedButton + 1}`;\r\n    const currentData = groups[selectedGroup].data[currentJoint].mappingData;\r\n\r\n    currentData.PL = postureSlider.leftBound;\r\n    currentData.PR = postureSlider.rightBound;\r\n    currentData.AL = armSlider.leftBound;\r\n    currentData.AR = armSlider.rightBound;\r\n    currentData.PHL = postureSlider.output[0];\r\n    currentData.PHR = postureSlider.output[1];\r\n    currentData.AHL = armSlider.output[0];\r\n    currentData.AHR = armSlider.output[1];\r\n\r\n    console.log(`Mapping data saved for ${currentJoint} in group ${selectedGroup}`);\r\n}\r\n\r\nwindow.resetMappingData = () => {\r\n    if (selectedGroup === null || !groups[selectedGroup]) return;\r\n\r\n    const currentJoint = `J${selectedButton + 1}`;\r\n    const currentData = groups[selectedGroup].data[currentJoint].mappingData;\r\n\r\n    Object.assign(currentData, defaultAxisValues.posture, defaultAxisValues.arm);\r\n\r\n    updateSliders(currentData);\r\n    console.log(`Mapping data reset to default for ${currentJoint} in group ${selectedGroup}`);\r\n}\r\n\r\nfunction enableGroupNameEdit(card, groupIndex) {\r\n    const contentDiv = card.querySelector('.angleCard-content');\r\n\r\n    card.addEventListener('dblclick', (e) => {\r\n        if (e.target === contentDiv) {\r\n            const currentName = contentDiv.textContent;\r\n            const input = document.createElement('input');\r\n            input.value = currentName;\r\n            input.className = 'edit-group-name';\r\n            input.style.width = '100%';\r\n            input.style.boxSizing = 'border-box';\r\n            input.style.padding = '8px 8px 8px 0';\r\n            input.style.border = 'none';\r\n            input.style.backgroundColor = 'transparent';\r\n            input.style.font = 'inherit';\r\n\r\n            contentDiv.textContent = '';\r\n            contentDiv.appendChild(input);\r\n            input.focus();\r\n\r\n            input.addEventListener('blur', finishEdit);\r\n            input.addEventListener('keypress', (e) => {\r\n                if (e.key === 'Enter') {\r\n                    finishEdit();\r\n                }\r\n            });\r\n\r\n            function finishEdit() {\r\n                const newName = input.value.trim() || 'default';\r\n                groups[groupIndex].name = newName;\r\n                contentDiv.textContent = newName;\r\n                updateGroups();\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\nclass NumericRangeSlider {\r\n    constructor(container, options) {\r\n        this.container = document.getElementById(container);\r\n        this.leftInput = this.container.previousElementSibling;\r\n        this.rightInput = this.container.nextElementSibling;\r\n        this.leftBound = options.leftBound;\r\n        this.rightBound = options.rightBound;\r\n        this.values = options.values || [this.leftBound, this.rightBound];\r\n        this.step = options.step || 1;\r\n        this.onChange = options.onChange || (() => { });\r\n        this.dragging = null;\r\n        this.output = options.values || [this.leftBound, this.rightBound];\r\n\r\n        this.init();\r\n    }\r\n\r\n    init() {\r\n        this.range = document.createElement('div');\r\n        this.range.className = 'slider-range';\r\n        this.container.appendChild(this.range);\r\n\r\n        this.handles = this.values.map((value, index) => {\r\n            const handle = document.createElement('div');\r\n            handle.className = 'slider-handle';\r\n            handle.setAttribute('data-index', index);\r\n\r\n            const label = document.createElement('div');\r\n            label.className = 'slider-label';\r\n\r\n            handle.appendChild(label);\r\n            this.container.appendChild(handle);\r\n\r\n            handle.addEventListener('mousedown', this.startDragging.bind(this));\r\n            return handle;\r\n        });\r\n\r\n        this.leftInput.addEventListener('change', this.updateFromInput.bind(this));\r\n        this.rightInput.addEventListener('change', this.updateFromInput.bind(this));\r\n\r\n        this.updateHandles();\r\n    }\r\n\r\n    startDragging(e) {\r\n        e.preventDefault();\r\n        this.dragging = parseInt(e.target.getAttribute('data-index'));\r\n        document.addEventListener('mousemove', this.drag.bind(this));\r\n        document.addEventListener('mouseup', this.stopDragging.bind(this));\r\n    }\r\n\r\n    stopDragging() {\r\n        this.dragging = null;\r\n        document.removeEventListener('mousemove', this.drag.bind(this));\r\n        document.removeEventListener('mouseup', this.stopDragging.bind(this));\r\n    }\r\n\r\n    drag(e) {\r\n        if (this.dragging === null) return;\r\n\r\n        const rect = this.container.getBoundingClientRect();\r\n        let position = (e.clientX - rect.left) / rect.width;\r\n        position = Math.max(0, Math.min(1, position));\r\n\r\n        const value = this.leftBound + (this.rightBound - this.leftBound) * position;\r\n        const snappedValue = Math.round(value / this.step) * this.step;\r\n\r\n        if (this.leftBound <= this.rightBound)\r\n            this.values[this.dragging] = Math.max(this.leftBound, Math.min(this.rightBound, snappedValue));\r\n        else\r\n            this.values[this.dragging] = Math.max(this.rightBound, Math.min(this.leftBound, snappedValue));\r\n        this.updateHandles();\r\n        this.onChange(this.values);\r\n    }\r\n\r\n    updateFromInput() {\r\n        const leftOrigin = this.leftBound;\r\n        const rightOrigin = this.rightBound;\r\n        this.leftBound = parseFloat(this.leftInput.value);\r\n        this.rightBound = parseFloat(this.rightInput.value);\r\n        if ((rightOrigin - leftOrigin) * (this.rightBound - this.leftBound) < 0)\r\n            this.values = [this.leftBound, this.rightBound];\r\n        else {\r\n            let minor, major;\r\n            if (this.leftBound <= this.rightBound) {\r\n                minor = this.leftBound;\r\n                major = this.rightBound;\r\n            } else {\r\n                minor = this.rightBound;\r\n                major = this.leftBound\r\n            }\r\n            if (this.values[0] < minor)\r\n                this.values[0] = minor;\r\n            if (this.values[0] > major)\r\n                this.values[0] = major;\r\n            if (this.values[1] < minor)\r\n                this.values[1] = minor;\r\n            if (this.values[1] > major)\r\n                this.values[1] = major;\r\n        }\r\n        this.updateHandles();\r\n        this.onChange(this.values);\r\n    }\r\n\r\n    updateHandles() {\r\n        const leftPosition = (this.values[0] - this.leftBound) / (this.rightBound - this.leftBound);\r\n        const rightPosition = (this.values[1] - this.leftBound) / (this.rightBound - this.leftBound);\r\n\r\n        this.handles.forEach((handle, index) => {\r\n            const position = index === 0 ? leftPosition : rightPosition;\r\n            handle.style.left = `${position * 100}%`;\r\n            handle.querySelector('.slider-label').textContent = this.values[index];\r\n        });\r\n\r\n        this.range.style.left = `${Math.min(leftPosition, rightPosition) * 100}%`;\r\n        this.range.style.right = `${(1 - Math.max(leftPosition, rightPosition)) * 100}%`;\r\n\r\n        if (this.values[0] > this.values[1] && this.leftBound <= this.rightBound ||\r\n            this.values[0] <= this.values[1] && this.leftBound > this.rightBound)\r\n            this.output = [this.values[1], this.values[0]];\r\n        else\r\n            this.output = this.values;\r\n        // console.log(this.output);\r\n    }\r\n\r\n    setBounds(left, right) {\r\n        this.leftBound = left;\r\n        this.rightBound = right;\r\n        this.leftInput.value = left;\r\n        this.rightInput.value = right;\r\n        this.updateHandles();\r\n    }\r\n\r\n    setValues(values) {\r\n        this.values = values.map(value => Math.max(Math.min(this.leftBound, this.rightBound), Math.min(Math.max(this.leftBound, this.rightBound), value)));\r\n        this.updateHandles();\r\n    }\r\n}\r\n\r\n// Initialize sliders\r\nconst postureSlider = new NumericRangeSlider('postureSlider', {\r\n    leftBound: 0,\r\n    rightBound: 360,\r\n    values: [0, 360],\r\n    step: 1\r\n});\r\n\r\nconst armSlider = new NumericRangeSlider('armSlider', {\r\n    leftBound: 0,\r\n    rightBound: 360,\r\n    values: [0, 360],\r\n    step: 1\r\n});\r\n\r\nconst buttonSlider = document.querySelector('.button-23d-slider');\r\nconst button2D = document.getElementById('button2D');\r\nconst button3D = document.getElementById('button3D');\r\n\r\nlet is3D = false;\r\n\r\nfunction toggleButton(button) {\r\n    if (!button.classList.contains('active')) {\r\n        button2D.classList.toggle('active');\r\n        button3D.classList.toggle('active');\r\n        buttonSlider.style.transform = button === button2D ? 'translateY(0)' : 'translateY(40px)';\r\n        is3D = button === button3D;\r\n    }\r\n    if (button === button2D)\r\n        button2D.disabled = false;\r\n}\r\n\r\nfunction updateIs3D() {\r\n    const is3D = groups[selectedGroup].data[`J${selectedButton + 1}`].is3D;\r\n    buttonSlider.style.transform = !is3D ? 'translateY(0)' : 'translateY(40px)';\r\n    if (!is3D) {\r\n        button2D.classList.add('active');\r\n        button3D.classList.remove('active');\r\n    } else {\r\n        button2D.classList.remove('active');\r\n        button3D.classList.add('active');\r\n    }\r\n    button2D.disabled = false;\r\n}\r\n\r\nbutton2D.addEventListener('click', (e) => {\r\n    e.stopPropagation();\r\n    toggleButton(button2D);\r\n});\r\nbutton3D.addEventListener('click', (e) => {\r\n    e.stopPropagation();\r\n    toggleButton(button3D);\r\n});\r\n\r\n// Set initial state to 3D\r\n// buttonSlider.style.transform = 'translateY(40px)';"]}